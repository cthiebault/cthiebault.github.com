---
layout: post
title: "Base de données NoSQL OrientDB"
description: ""
category: ""
tags: [java, orientdb]
---
{% include JB/setup %}

Récemment, dans un de nos projets, nous avons opté pour la base de données NoSQL [OrientDB](http://www.orientdb.org).
L’idée était de remplacer notre [Hibernate](http://hibernate.org) sur [HSQL](http://hsqldb.org) pour une base de donnée orientée document mais qui soit embarquable (en gros pas [MongoDB](http://www.mongodb.org)). OrientDB semble être la seule qui soit "embeddable" en java pour le moment...

[OrientDB](http://www.orientdb.org) supporte les base de données orientée [graph](https://github.com/orientechnologies/orientdb/wiki/Graph-Database-Tinkerpop), [document](https://github.com/orientechnologies/orientdb/wiki/Document-Database) et [objet](https://github.com/orientechnologies/orientdb/wiki/Object-Database).

## Serveur OrientDB embarqué

Assez simple à configuer en suivant la doc...
Chez moi ca donne ca en gros:

```java
@Component
public class OrientDbServerFactory {

  private static final Logger log = LoggerFactory.getLogger(OrientDbServerFactory.class);

  private String url;

  private String username;

  private String password;

  private OServer server;

  @Value("${orientdb.url}")
  public void setUrl(@Nonnull String url) {
    this.url = url;
  }

  @Value("${orientdb.username}")
  public void setUsername(String username) {
    this.username = username;
  }

  @Value("${orientdb.password}")
  public void setPassword(String password) {
    this.password = password;
  }

  @PostConstruct
  public void start() throws Exception {
    log.info("Start OrientDB server ({})", url);

    System.setProperty("ORIENTDB_HOME", url);
    server = new OServer().startup().activate();

    // create database if does not exist
    ODatabase database = new OObjectDatabaseTx(url);
    if(!database.exists()) database.create();
    database.close();
  }

  @PreDestroy
  public void stop() {
    log.info("Stop OrientDB server ({})", url);
    if(server != null) server.shutdown();
  }

  @Nonnull
  public OServer getServer() {
    return server;
  }

  @Nonnull
  public OObjectDatabaseTx getObjectTx() {
    return OObjectDatabasePool.global().acquire(url, username, password);
  }

  @Nonnull
  public ODatabaseDocumentTx getDocumentTx() {
    return ODatabaseDocumentPool.global().acquire(url, username, password);
  }

}

```


## Base de données orientée Objet

OrientDB utilise ici une base de donnees orientée Document et la reflection pour déterminer les champs du document. OrientDB déduit le schema des objects une seule fois lors de l'enregistrement de la classe à persister.

Dans un premier temps j'ai choisi d'utiliser cette methode car ca m'évitait de faire un mapping pojo <--> document et ca ressemblait beaucoup à Hibernate... je restais donc en terrain connu.

## Base de données orientée Document